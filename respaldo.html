<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hechos de Tránsito — GELM 2026</title>

<!-- LIBRERÍAS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/docx@8.2.2/build/index.umd.js"></script>
<script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>

<style>
body{
  margin:0;
  font-family:system-ui;
  background:radial-gradient(circle at top,#24002b,#060012);
  color:#e9f9ff;
}
.panel{
  max-width:1100px;
  margin:30px auto;
  padding:25px;
  background:rgba(3,5,20,.96);
  border-radius:26px;
  box-shadow:0 0 40px rgba(0,234,255,.35);
}
h1{text-align:center;color:#00ffc8;margin:0}
.sub{text-align:center;color:#9cb3d8;font-size:.85rem;margin-bottom:20px}

.grid{
  display:grid;
  grid-template-columns:repeat(5,1fr);
  gap:12px;
}
.full{grid-column:1/-1}
label{font-size:.7rem;color:#9cb3d8;text-transform:uppercase}
input,textarea{
  width:100%;padding:10px;
  border-radius:12px;
  border:1px solid #00eaff;
  background:#020616;color:#fff;
}
textarea{min-height:80px}

.actions{
  display:flex;flex-wrap:wrap;
  gap:10px;margin:16px 0;
}
button{
  border-radius:999px;
  padding:10px 20px;
  border:none;cursor:pointer;
  font-weight:600;
}
.save{background:#00ffc8;color:#001}
.pdf{background:#b300ff;color:#fff}
.word{background:#0d6efd;color:#fff}
.excel{background:#28a745;color:#fff}
.del{background:#ff0033;color:#fff}

table{
  width:100%;
  border-collapse:collapse;
  margin-top:18px;
  font-size:.85rem;
}
thead{
  background:linear-gradient(90deg,#00ffc8,#00eaff);
  color:#001;
}
th,td{padding:8px;border-bottom:1px solid rgba(0,255,200,.2)}
tbody tr:nth-child(even){background:rgba(0,255,200,.05)}

footer{
  text-align:center;
  margin-top:20px;
  font-size:.75rem;
  color:#9cb3d8;
}
</style>
</head>

<body>
<div class="panel" id="pdfArea">
<h1>HECHOS DE TRÁNSITO — GELM 2026</h1>
<div class="sub">PMT Chimaltenango — Sistema GELM</div>

<div class="grid">
<div><label>Fecha</label><input type="date" id="fecha"></div>
<div><label>Hora</label><input type="time" id="hora"></div>
<div><label>Lugar</label><input id="lugar"></div>
<div><label>Placa A</label><input id="placaA"></div>
<div><label>Placa B</label><input id="placaB"></div>
<div class="full"><label>Nota / Acuerdo</label>
<textarea id="nota">Las partes manifiestan llegar a un acuerdo en el lugar...</textarea>
</div>
</div>

<div class="actions">
<button class="save" onclick="guardar()">Guardar</button>
<button class="pdf" onclick="exportarPDF()">PDF</button>
<button class="word" onclick="exportarWord()">Word</button>
<button class="excel" onclick="exportarExcel()">Excel</button>
<button class="del" onclick="borrar()">Borrar Todo</button>
</div>

<table>
<thead>
<tr><th>Fecha</th><th>Hora</th><th>Lugar</th><th>Vehículos</th></tr>
</thead>
<tbody id="tabla"></tbody>
</table>

<footer>© 2026 — BY GELM — PMT Chimaltenango</footer>
</div>

<script>
const KEY="hechos_transito_gelm_2026";
let data=JSON.parse(localStorage.getItem(KEY)||"[]");
const $=id=>document.getElementById(id);

function guardar(){
  if(!fecha.value||!lugar.value){
    alert("Fecha y lugar obligatorios");return;
  }
  const r={
    fecha:fecha.value,
    hora:hora.value||"",
    lugar:lugar.value,
    vehiculos:`${placaA.value||"-"} / ${placaB.value||"-"}`,
    nota:nota.value
  };
  data.push(r);
  localStorage.setItem(KEY,JSON.stringify(data));
  render();
}

function render(){
  tabla.innerHTML="";
  data.forEach(r=>{
    tabla.innerHTML+=`
    <tr>
      <td>${r.fecha}</td>
      <td>${r.hora}</td>
      <td>${r.lugar}</td>
      <td>${r.vehiculos}</td>
    </tr>`;
  });
}
render();

function borrar(){
  if(confirm("¿Borrar todos los registros?")){
    data=[];localStorage.removeItem(KEY);render();
  }
}

function exportarPDF(){
  html2pdf().from(pdfArea)
    .set({filename:"HECHOS_TRANSITO_2026.pdf"}).save();
}

function exportarWord(){
  const {Document,Packer,Paragraph}=window.docx;
  const doc=new Document({
    sections:[{
      children:data.map(r=>
        new Paragraph(`${r.fecha} ${r.hora} | ${r.lugar} | ${r.vehiculos}\n${r.nota}`)
      )
    }]
  });
  Packer.toBlob(doc).then(b=>saveAs(b,"HECHOS_TRANSITO_2026.docx"));
}

function exportarExcel(){
  const ws=XLSX.utils.json_to_sheet(data);
  const wb=XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb,ws,"Hechos");
  XLSX.writeFile(wb,"HECHOS_TRANSITO_2026.xlsx");
}
</script>
</body>
</html>
