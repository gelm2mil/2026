<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CONSIGNACIONES 2026 — PMT Chimaltenango</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

<style>
:root{
--gelm-cyan:#00eaff;--gelm-cyan-soft:#00ffc8;--gelm-bg:#020510;
--gelm-card:rgba(3,5,25,.96);--gelm-text:#e9f9ff;--gelm-danger:#ff0044
}
body{margin:0;padding:10px;font-family:Segoe UI,system-ui;background:var(--gelm-bg);color:var(--gelm-text);display:flex;justify-content:center}
.container{width:100%;max-width:900px}
.panel{background:var(--gelm-card);border-radius:25px;border:1px solid rgba(0,234,255,.3);padding:20px}
h1{text-align:center;color:var(--gelm-cyan-soft);margin-bottom:20px}
.section{background:rgba(255,255,255,.02);border-radius:15px;padding:15px;margin-bottom:15px}
.section-title{color:var(--gelm-cyan);font-size:.85rem;font-weight:bold;margin-bottom:10px}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:12px}
label{font-size:.75rem;color:#9cb3d8;text-transform:uppercase}
input,select,textarea{width:100%;padding:10px;border-radius:10px;background:#000;border:1px solid rgba(0,234,255,.3);color:#fff}
textarea{min-height:70px}
.actions{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:20px}
.btn{padding:14px;border-radius:35px;border:none;font-weight:bold;cursor:pointer}
.btn-save{background:linear-gradient(90deg,#00eaff,#00ffc8);color:#000}
.btn-pdf{background:linear-gradient(90deg,#b300ff,#ff0044);color:#fff}
.btn-excel{background:#28a745;color:#fff}
.btn-word{background:#1b5fd6;color:#fff}
.history{margin-top:25px}
table{width:100%;border-collapse:collapse;font-size:.85rem}
th{background:var(--gelm-cyan);color:#000;padding:10px}
td{padding:10px;border-bottom:1px solid rgba(0,234,255,.1)}
</style>
</head>

<body>
<div class="container">
<div class="panel">
<h1>Boleta de Consignación 2026</h1>

<div class="section grid">
<div><label>Fecha</label><input type="date" id="fecha"></div>
<div><label>Hora</label><input type="time" id="hora"></div>
</div>

<div class="section">
<div class="section-title">Conductor</div>
<div class="grid">
<input id="c_nombre" placeholder="Nombre completo">
<input id="c_licencia" placeholder="Licencia">
<input id="c_dpi" placeholder="DPI">
</div>
</div>

<div class="section">
<div class="section-title">Vehículo</div>
<div class="grid">
<input id="v_placa" placeholder="Placa">
<input id="v_marca" placeholder="Marca">
<input id="v_color" placeholder="Color">
<input id="v_nit" placeholder="NIT">
</div>
</div>

<div class="section">
<div class="section-title">Hecho</div>
<textarea id="h_motivo" placeholder="Motivo"></textarea>
<textarea id="h_obs" placeholder="Observaciones"></textarea>
<input id="h_direccion" placeholder="Dirección">
</div>

<div class="section">
<div class="section-title">Autoridad</div>
<div class="grid">
<input id="a_nombre" placeholder="Agente">
<input id="a_chapa" placeholder="Chapa">
</div>
</div>

<div class="actions">
<button class="btn btn-save" onclick="saveData()">Guardar</button>
<button class="btn btn-pdf" onclick="makePDF()">PDF</button>
<button class="btn btn-excel" onclick="exportXLS()">Excel</button>
<button class="btn btn-word" onclick="exportWord()">Word</button>
</div>

<div class="history">
<table>
<thead><tr><th>Fecha</th><th>Placa</th><th>Conductor</th></tr></thead>
<tbody id="historial"></tbody>
</table>
</div>

</div>
</div>

<script>
const KEY="pmt_consigna_2026";
let db=JSON.parse(localStorage.getItem(KEY)||"[]");

function saveData(){
const r={
fecha:fecha.value,hora:hora.value,placa:v_placa.value,
conductor:c_nombre.value,licencia:c_licencia.value,dpi:c_dpi.value,
marca:v_marca.value,color:v_color.value,nit:v_nit.value,
motivo:h_motivo.value,obs:h_obs.value,dir:h_direccion.value,
agente:a_nombre.value,chapa:a_chapa.value
};
if(!r.fecha||!r.placa)return alert("Fecha y placa requeridas");
db.push(r);localStorage.setItem(KEY,JSON.stringify(db));render();
}

function render(){
historial.innerHTML=db.map(x=>`<tr><td>${x.fecha}</td><td>${x.placa}</td><td>${x.conductor}</td></tr>`).join("");
}

function makePDF(){
const{jsPDF}=window.jspdf;const d=new jsPDF();
let y=20;
db.forEach((r,i)=>{
d.text(`CONS ${i+1} | ${r.fecha} ${r.hora}`,20,y);y+=6;
d.text(`Placa: ${r.placa} | Conductor: ${r.conductor}`,20,y);y+=10;
if(y>260){d.addPage();y=20;}
});
d.save("CONSIGNACIONES_2026.pdf");
}

function exportXLS(){
const ws=XLSX.utils.json_to_sheet(db);
const wb=XLSX.utils.book_new();
XLSX.utils.book_append_sheet(wb,ws,"2026");
XLSX.writeFile(wb,"CONSIGNACIONES_2026.xlsx");
}

function exportWord(){
let html=`<h2>CONSIGNACIONES 2026 – PMT CHIMALTENANGO</h2>`;
db.forEach(r=>{
html+=`<p><b>Fecha:</b> ${r.fecha} ${r.hora}<br>
<b>Placa:</b> ${r.placa}<br>
<b>Conductor:</b> ${r.conductor}<br>
<b>Motivo:</b> ${r.motivo}</p><hr>`;
});
const blob=new Blob(['\ufeff'+html],{type:'application/msword'});
const a=document.createElement('a');
a.href=URL.createObjectURL(blob);
a.download="CONSIGNACIONES_2026.doc";
a.click();
}
render();
</script>
</body>
</html>
