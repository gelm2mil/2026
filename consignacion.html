<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CONSIGNACIONES 2026 — PMT Chimaltenango</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

<style>
body{
    margin:0;
    font-family:Segoe UI,system-ui;
    background:#020510;
    color:#e9f9ff;
    display:flex;
    justify-content:center;
}
.panel{
    max-width:900px;
    width:100%;
    margin:15px;
    padding:20px;
    background:rgba(3,5,25,.96);
    border-radius:25px;
    border:1px solid rgba(0,234,255,.3);
}
h1{
    text-align:center;
    color:#00ffc8;
}
label{
    font-size:.75rem;
    color:#9cb3d8;
    text-transform:uppercase;
}
input,textarea,select{
    width:100%;
    padding:10px;
    border-radius:10px;
    border:1px solid #00eaff;
    background:#000;
    color:#fff;
}
.grid{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(150px,1fr));
    gap:12px;
}
.actions{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:12px;
    margin-top:20px;
}
button{
    padding:14px;
    border-radius:35px;
    border:none;
    font-weight:bold;
    cursor:pointer;
}
.btn-save{background:linear-gradient(90deg,#00eaff,#00ffc8);color:#000;}
.btn-pdf{background:linear-gradient(90deg,#b300ff,#ff0044);color:#fff;}
.btn-excel{background:#28a745;color:#fff;}
.btn-word{background:#0d6efd;color:#fff;}
.btn-audit{background:#6610f2;color:#fff;}
.btn-danger{background:#dc3545;color:#fff;}
table{
    width:100%;
    border-collapse:collapse;
    margin-top:20px;
    font-size:.85rem;
}
th{
    background:#00eaff;
    color:#000;
    padding:8px;
}
td{
    padding:8px;
    border-bottom:1px solid rgba(0,234,255,.2);
}
</style>
</head>

<body>
<div class="panel">
<h1>Boleta de Consignación 2026</h1>

<div class="grid">
<div><label>Fecha</label><input type="date" id="fecha"></div>
<div><label>Hora</label><input type="time" id="hora"></div>
</div>

<div class="grid">
<div><label>Conductor</label><input id="conductor"></div>
<div><label>Licencia</label><input id="licencia"></div>
<div><label>DPI</label><input id="dpi"></div>
</div>

<div class="grid">
<div><label>Placa</label><input id="placa"></div>
<div><label>Marca</label><input id="marca"></div>
<div><label>NIT</label><input id="nit"></div>
</div>

<label>Motivo</label>
<textarea id="motivo"></textarea>

<div class="grid">
<div><label>Agente</label><input id="agente"></div>
<div><label>Chapa</label><input id="chapa"></div>
</div>

<div class="actions">
<button class="btn-save" onclick="guardar()">Guardar</button>
<button class="btn-pdf" onclick="pdf()">PDF</button>
<button class="btn-word" onclick="wordIndividual()">Word</button>
<button class="btn-audit" onclick="wordAuditoria()">Auditoría</button>
<button class="btn-excel" onclick="excel()">Excel</button>
<button class="btn-danger" onclick="borrarTodo()">Borrar Todo</button>
</div>

<table>
<thead>
<tr><th>Fecha</th><th>Placa</th><th>Conductor</th></tr>
</thead>
<tbody id="tabla"></tbody>
</table>

</div>

<script>
const KEY="consignaciones_2026";
let db=JSON.parse(localStorage.getItem(KEY))||[];

function guardar(){
    const r={
        fecha:fecha.value,
        hora:hora.value,
        placa:placa.value,
        conductor:conductor.value,
        licencia:licencia.value,
        dpi:dpi.value,
        marca:marca.value,
        nit:nit.value,
        motivo:motivo.value,
        agente:agente.value,
        chapa:chapa.value
    };
    if(!r.fecha||!r.placa) return alert("Fecha y placa obligatorias");
    db.push(r);
    localStorage.setItem(KEY,JSON.stringify(db));
    render();
}

function render(){
    tabla.innerHTML=db.map(x=>`
    <tr>
        <td>${x.fecha}</td>
        <td>${x.placa}</td>
        <td>${x.conductor}</td>
    </tr>`).join("");
}
render();

function wordIndividual(){
    const r=db.at(-1);
    if(!r) return;
    generarWord([r],"CONSIGNACION");
}

function wordAuditoria(){
    if(!db.length) return;
    generarWord(db,"AUDITORIA_MENSUAL");
}

function generarWord(data,nombre){
    let html=`<h2>CONSIGNACIONES 2026 — PMT CHIMALTENANGO</h2>`;
    data.forEach(r=>{
        html+=`
        <p><b>Fecha:</b> ${r.fecha} ${r.hora}</p>
        <p><b>Placa:</b> ${r.placa}</p>
        <p><b>Conductor:</b> ${r.conductor}</p>
        <p><b>Motivo:</b> ${r.motivo}</p>
        <hr>`;
    });
    const blob=new Blob([html],{type:"application/msword"});
    const a=document.createElement("a");
    a.href=URL.createObjectURL(blob);
    a.download=nombre+"_2026.doc";
    a.click();
}

function excel(){
    const ws=XLSX.utils.json_to_sheet(db);
    const wb=XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb,ws,"2026");
    XLSX.writeFile(wb,"CONSIGNACIONES_2026.xlsx");
}

function pdf(){
    const {jsPDF}=window.jspdf;
    const d=new jsPDF();
    d.text("CONSIGNACIONES 2026",20,20);
    db.forEach((r,i)=>{
        d.text(`${i+1}. ${r.fecha} - ${r.placa}`,20,30+i*8);
    });
    d.save("CONSIGNACIONES_2026.pdf");
}

function borrarTodo(){
    if(confirm("¿BORRAR TODO EL AÑO?")){
        db=[];
        localStorage.removeItem(KEY);
        render();
    }
}
</script>
</body>
</html>
