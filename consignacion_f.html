<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AGEN2026 · Sistema de Consignaciones</title>

  <!-- PWA / Base -->
  <link rel="manifest" href="manifest.webmanifest" />
  <meta name="theme-color" content="#00eaff" />

  <!-- Estilos base (AGEN2026) -->
  <style>
    :root{
      --pri:#00eaff; --bg:#0b0f14; --card:#121826; --txt:#e6edf3; --mut:#9fb3c8;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu;
      background:linear-gradient(180deg,#0b0f14,#0f1522);color:var(--txt)}
    header{padding:16px 20px;border-bottom:1px solid #1f2a44}
    header h1{margin:0;font-size:1.2rem;color:var(--pri)}
    main{padding:20px;max-width:1100px;margin:auto}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:16px}
    .card{background:var(--card);border:1px solid #1f2a44;border-radius:14px;padding:16px}
    .card h2{margin:0 0 8px 0;font-size:1rem}
    label{font-size:.85rem;color:var(--mut)}
    input,select,textarea,button{
      width:100%;margin-top:6px;margin-bottom:12px;padding:10px 12px;
      border-radius:10px;border:1px solid #26345a;background:#0e1422;color:var(--txt)
    }
    button{background:var(--pri);color:#001018;border:none;font-weight:600;cursor:pointer}
    button.secondary{background:#233a5e;color:var(--txt)}
    .row{display:flex;gap:10px;flex-wrap:wrap}
    .row>*{flex:1}
    footer{padding:16px;color:#7aa2c7;text-align:center}
    .badge{display:inline-block;padding:4px 8px;border-radius:999px;background:#0e2230;color:#7fdcff;font-size:.75rem}
  </style>

  <script>
    // Service Worker
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js');
    }

    // Utilidades de respaldo (misma lógica que ya usas en 2026)
    const DB_KEY = 'AGEN2026_CONSIGNACIONES';

    function saveLocal(data){
      const all = JSON.parse(localStorage.getItem(DB_KEY) || '[]');
      all.push({...data, _ts: new Date().toISOString()});
      localStorage.setItem(DB_KEY, JSON.stringify(all));
    }

    function exportJSON(){
      const blob = new Blob([localStorage.getItem(DB_KEY) || '[]'], {type:'application/json'});
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'consignaciones_respaldo.json';
      a.click();
    }

    function submitConsignacion(e){
      e.preventDefault();
      const f = e.target;
      const data = {
        tipo: f.tipo.value,
        fecha: f.fecha.value,
        lugar: f.lugar.value,
        placa: f.placa.value,
        conductor: f.conductor.value,
        motivo: f.motivo.value,
        fundamento: f.fundamento.value,
        observaciones: f.obs.value
      };
      saveLocal(data);
      alert('✔ Consignación guardada en respaldo local');
      f.reset();
    }
  </script>
</head>
<body>
  <header>
    <h1>AGEN2026 <span class="badge">Consignaciones</span></h1>
  </header>

  <main>
    <div class="grid">
      <!-- FORMULARIO DE CONSIGNACIÓN -->
      <div class="card">
        <h2>Registro de consignación</h2>
        <form onsubmit="submitConsignacion(event)">
          <label>Tipo de consignación</label>
          <select name="tipo" required>
            <option value="">Seleccione…</option>
            <option>Motocicleta</option>
            <option>Vehículo liviano</option>
            <option>Camión</option>
            <option>Otro</option>
          </select>

          <div class="row">
            <div>
              <label>Fecha</label>
              <input type="date" name="fecha" required />
            </div>
            <div>
              <label>Lugar</label>
              <input type="text" name="lugar" placeholder="Zona / municipio" required />
            </div>
          </div>

          <div class="row">
            <div>
              <label>Placa</label>
              <input type="text" name="placa" required />
            </div>
            <div>
              <label>Conductor</label>
              <input type="text" name="conductor" />
            </div>
          </div>

          <label>Motivo</label>
          <textarea name="motivo" rows="3" required></textarea>

          <label>Fundamento legal</label>
          <textarea name="fundamento" rows="3" placeholder="Artículos aplicables…"></textarea>

          <label>Observaciones</label>
          <textarea name="obs" rows="2"></textarea>

          <button type="submit">Guardar consignación</button>
        </form>
      </div>

      <!-- ACCIONES / RESPALDOS -->
      <div class="card">
        <h2>Respaldos y control</h2>
        <p style="color:var(--mut)">Usa la misma lógica de guardado que ya funciona en <strong>/2026</strong>.</p>
        <button class="secondary" onclick="exportJSON()">Exportar respaldo (JSON)</button>
        <p style="font-size:.85rem;color:var(--mut)">Los datos se guardan offline en el navegador.</p>
      </div>
    </div>
  </main>

  <footer>
    AGEN2026 · Offline first · GitHub Pages
  </footer>
</body>
</html>
