<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>CONSï»¿IGNACIÃ“N PMT 2026 â€” Con Firma</title>

  <style>
    :root { --cyan: #00eaff; --magenta: #b300ff; --bg: #020510; }
    body { margin: 0; font-family: sans-serif; background: var(--bg); color: white; padding: 10px; }
    .shell { max-width: 800px; margin: auto; background: rgba(3,5,20,0.95); border: 1px solid #00eaff44; border-radius: 20px; padding: 15px; }

    header { text-align: center; border-bottom: 2px solid var(--cyan); margin-bottom: 20px; }
    .sec-t { color: var(--cyan); font-size: 11px; text-transform: uppercase; font-weight: bold; margin: 15px 0 5px; display: block; }

    .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
    .full { grid-column: 1 / -1; }

    input, select, textarea { width: 100%; padding: 12px; border-radius: 8px; border: 1px solid #333; background: #000; color: white; box-sizing: border-box; font-size: 16px; }
    .firma-box { background: #000; padding: 10px; border: 1px solid #333; border-radius: 8px; margin-top: 15px; }
    #firmaAgente, #firmaPiloto { width: 100%; height: 150px; background: #fff; border: 2px solid var(--cyan); border-radius: 6px; touch-action: none; }
    .firma-btns { margin-top: 5px; text-align: right; }
    .firma-btns button { background: #222; color: var(--cyan); border: 1px solid var(--cyan); padding: 6px 10px; border-radius: 4px; font-size: 14px; cursor: pointer; }

    .btn-group { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 20px; }
    .btn { padding: 15px; border-radius: 12px; border: none; font-weight: bold; text-transform: uppercase; cursor: pointer; }
    .b-save { background: var(--cyan); color: #000; grid-column: 1 / -1; }
    .b-pdf { background: var(--magenta); color: white; grid-column: 1 / -1; }

    /* Estilos para impresiÃ³n PDF si se usa html2pdf */
    @media print {
      body { background: white; color: black; padding: 0; }
      .shell { border: none; background: white; }
    }
  </style>

  <!-- LibrerÃ­a html2pdf.js vÃ­a CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>
<body>

<div class="shell">

  <header>
    <h2 style="margin:5px; color:var(--cyan);">CONSï»¿IGNACIÃ“N PMT 2026</h2>
    <small>UNIDAD DE TRANSPORTES â€” CHIMAL</small>
  </header>

  <!-- DATOS DEL CONDUCTOR -->
  <span class="sec-t">Datos del Conductor</span>
  <div class="grid">
    <input type="text" id="piloto" placeholder="Nombre Piloto" class="full">
    <input type="text" id="licencia" placeholder="No. Licencia">
    <select id="clase">
      <option>Clase A</option><option>Clase B</option><option>Clase C</option><option>Clase M</option>
    </select>
    <input type="text" id="dpi" placeholder="DPI / Documento" class="full">
  </div>

  <!-- DATOS DEL VEHÃCULO -->
  <span class="sec-t">Datos del VehÃ­culo</span>
  <div class="grid">
    <input type="text" id="placa" placeholder="Placas">
    <select id="tipoV"><option>AutomÃ³vil</option><option>Motocicleta</option><option>CamiÃ³n</option><option>Bus</option></select>
    <input type="text" id="marca" placeholder="Marca">
    <input type="text" id="color" placeholder="Color">
    <input type="text" id="nit" placeholder="NIT VehÃ­culo" class="full">
  </div>

  <!-- INVENTARIO (simple ejemplo) -->
  <span class="sec-t">Inventario</span>
  <div class="grid">
    <select id="inv_antena"><option value="">Antena...</option><option>Buena</option><option>Quebrada</option><option>No tiene</option></select>
    <select id="inv_radio"><option value="">Radio...</option><option>Completo</option><option>Sin carÃ¡tula</option><option>No funciona</option><option>No tiene</option></select>
    <select id="inv_llanta"><option value="">Llanta repuesto...</option><option>Buena</option><option>Lisa</option><option>Pinchada</option><option>No tiene</option></select>
    <select id="inv_espejo"><option value="">Espejos...</option><option>Completos</option><option>Uno quebrado</option><option>Ambos quebrados</option><option>No tiene</option></select>
  </div>

  <!-- DATOS DE CONSIGNACIÃ“N -->
  <span class="sec-t">Operativo y Motivo</span>
  <div class="grid">
    <input type="date" id="fecha">
    <input type="text" id="agente" placeholder="Nombre Agente">
    <input type="text" id="chapa" placeholder="Chapa No.">
    <input type="text" id="boleta" placeholder="No. Boleta InfracciÃ³n">
    <textarea id="motivo" placeholder="Motivo de la consignaciÃ³n..." class="full" rows="2"></textarea>
  </div>

  <!-- FIRMAS -->
  <span class="sec-t">Firma del Agente</span>
  <div class="firma-box">
    <canvas id="firmaAgente"></canvas>
    <div class="firma-btns">
      <button type="button" onclick="limpiarFirma('firmaAgente')">Limpiar firma</button>
    </div>
  </div>

  <span class="sec-t">Firma del Piloto</span>
  <div class="firma-box">
    <canvas id="firmaPiloto"></canvas>
    <div class="firma-btns">
      <button type="button" onclick="limpiarFirma('firmaPiloto')">Limpiar firma</button>
    </div>
  </div>

  <!-- BOTÃ“N GENERAR PDF -->
  <div class="btn-group">
    <button class="btn b-pdf" onclick="generarPDF()">ðŸ“„ Generar PDF con firmas</button>
  </div>

</div>

<script>
  // INIT: ajuste de canvas, manejo de firma
  function prepararFirma(idCanvas) {
    const canvas = document.getElementById(idCanvas);
    const ctx = canvas.getContext("2d");
    let dibujando = false;

    function ajustar() {
      canvas.width = canvas.offsetWidth;
      canvas.height = 150;
      ctx.lineWidth = 2;
      ctx.lineCap = "round";
      ctx.strokeStyle = "#000";
    }
    ajustar();
    window.addEventListener("resize", ajustar);

    canvas.addEventListener("pointerdown", e => { dibujando = true; ctx.beginPath(); ctx.moveTo(e.offsetX, e.offsetY); });
    canvas.addEventListener("pointermove", e => { if(!dibujando) return; ctx.lineTo(e.offsetX, e.offsetY); ctx.stroke(); });
    canvas.addEventListener("pointerup", () => dibujando = false);
    canvas.addEventListener("pointerleave", () => dibujando = false);
  }

  prepararFirma("firmaAgente");
  prepararFirma("firmaPiloto");

  function limpiarFirma(idCanvas) {
    const c = document.getElementById(idCanvas);
    const ctx = c.getContext("2d");
    ctx.clearRect(0, 0, c.width, c.height);
  }

  function generarPDF() {
    const opt = {
      margin:       0.5,
      filename:     'Consignacion_PMT_2026.pdf',
      image:        { type: 'jpeg', quality: 0.98 },
      html2canvas:  { scale: 2, useCORS: true },
      jsPDF:        { unit: 'in', format: 'letter', orientation: 'portrait' }
    };

    // Antes de generar, podrÃ­as validar campos obligatorios
    html2pdf().set(opt).from(document.body).save();
  }
</script>

</body>
</html>
