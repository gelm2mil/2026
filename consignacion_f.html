<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Consignaciones PMT 2026</title>

<style>
body{
  margin:0;
  font-family:Arial, Helvetica, sans-serif;
  background:#f4f4f4;
  color:#000;
}
.shell{
  max-width:900px;
  margin:auto;
  background:#fff;
  padding:15px;
}
h2{
  text-align:center;
  margin:5px 0;
}
.sec{
  margin-top:15px;
  font-weight:bold;
  font-size:13px;
  border-bottom:1px solid #ccc;
}
.grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:8px;
  margin-top:8px;
}
.full{ grid-column:1 / -1; }

input, select, textarea{
  width:100%;
  padding:10px;
  font-size:15px;
  box-sizing:border-box;
}

canvas{
  width:100%;
  height:150px;
  border:1px solid #000;
  background:#fff;
}

button{
  padding:12px;
  font-size:15px;
  cursor:pointer;
}

.actions{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:10px;
  margin-top:15px;
}

.log{
  margin-top:25px;
  border-top:2px solid #000;
  padding-top:10px;
}

.log-item{
  border-bottom:1px solid #ccc;
  padding:8px 0;
  font-size:14px;
}

small{ color:#555; }
</style>
</head>

<body>
<div class="shell">

<h2>CONSï»¿IGNACIÃ“N PMT 2026</h2>

<div class="sec">Datos del Conductor</div>
<div class="grid">
  <input id="piloto" placeholder="Nombre del piloto" class="full">
  <input id="licencia" placeholder="Licencia">
  <input id="dpi" placeholder="DPI">
</div>

<div class="sec">Datos del VehÃ­culo</div>
<div class="grid">
  <input id="placa" placeholder="Placa">
  <input id="marca" placeholder="Marca">
  <input id="color" placeholder="Color">
  <input id="tipo" placeholder="Tipo (auto, moto, camiÃ³n)">
</div>

<div class="sec">Datos del Agente</div>
<div class="grid">
  <input id="agente" placeholder="Nombre del agente">
  <input id="chapa" placeholder="Chapa">
</div>

<div class="sec">Motivo</div>
<textarea id="motivo" rows="2" placeholder="Motivo de la consignaciÃ³n"></textarea>

<div class="sec">Evidencia FotogrÃ¡fica</div>
<input type="file" id="fotos" accept="image/*" multiple>

<div class="sec">Firma del Agente</div>
<canvas id="firmaAgente"></canvas>
<button onclick="limpiarFirma('firmaAgente')">Limpiar firma agente</button>

<div class="sec">Firma del Piloto</div>
<canvas id="firmaPiloto"></canvas>
<button onclick="limpiarFirma('firmaPiloto')">Limpiar firma piloto</button>

<div class="actions">
  <button onclick="guardarConsignacion()">ðŸ’¾ Guardar consignaciÃ³n</button>
  <button onclick="alert('PDF se activa en el siguiente paso')">ðŸ“„ Generar PDF</button>
</div>

<div class="log">
  <h3>ðŸ“‹ BitÃ¡cora de consignaciones</h3>
  <div id="lista"></div>
</div>

</div>

<script>
/* ===== FIRMAS ===== */
function prepararFirma(id){
  const c=document.getElementById(id);
  const ctx=c.getContext("2d");
  let dib=false;

  function resize(){
    c.width=c.offsetWidth;
    c.height=150;
    ctx.lineWidth=2;
    ctx.lineCap="round";
    ctx.strokeStyle="#000";
  }
  resize(); window.addEventListener("resize",resize);

  c.addEventListener("pointerdown",e=>{
    dib=true; ctx.beginPath();
    ctx.moveTo(e.offsetX,e.offsetY);
  });
  c.addEventListener("pointermove",e=>{
    if(!dib) return;
    ctx.lineTo(e.offsetX,e.offsetY); ctx.stroke();
  });
  c.addEventListener("pointerup",()=>dib=false);
}
prepararFirma("firmaAgente");
prepararFirma("firmaPiloto");

function limpiarFirma(id){
  const c=document.getElementById(id);
  c.getContext("2d").clearRect(0,0,c.width,c.height);
}

/* ===== GUARDAR ===== */
function guardarConsignacion(){
  const data={
    fecha:new Date().toLocaleString(),
    piloto:piloto.value,
    licencia:licencia.value,
    dpi:dpi.value,
    placa:placa.value,
    marca:marca.value,
    color:color.value,
    tipo:tipo.value,
    agente:agente.value,
    chapa:chapa.value,
    motivo:motivo.value,
    firmaAgente:firmaAgente.toDataURL(),
    firmaPiloto:firmaPiloto.toDataURL()
  };

  const arr=JSON.parse(localStorage.getItem("consignaciones")||"[]");
  arr.push(data);
  localStorage.setItem("consignaciones",JSON.stringify(arr));
  mostrar();
  alert("ConsignaciÃ³n guardada");
}

/* ===== MOSTRAR ===== */
function mostrar(){
  const cont=document.getElementById("lista");
  cont.innerHTML="";
  const arr=JSON.parse(localStorage.getItem("consignaciones")||"[]");
  arr.reverse().forEach(c=>{
    const d=document.createElement("div");
    d.className="log-item";
    d.innerHTML=`
    <strong>${c.fecha}</strong><br>
    ðŸš— ${c.placa} â€” ${c.motivo}<br>
    ðŸ‘® ${c.agente} (${c.chapa})
    `;
    cont.appendChild(d);
  });
}
mostrar();
</script>
</body>
</html>
